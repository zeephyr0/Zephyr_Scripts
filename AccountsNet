# coded by DEM
# good luck =]

from telethon import TelegramClient, sync
from telethon import events, utils
from telethon.tl.functions.messages import GetDialogsRequest
from telethon.tl.functions.messages import SendMessageRequest
from telethon.tl.types import InputPeerEmpty, PeerUser, PeerChat, PeerChannel
from telethon.errors import FloodWaitError
from telethon.errors import SessionPasswordNeededError
import datetime
import requests
import time
import random
import tracemalloc
import asyncio
import concurrent.futures
import json

# –î–∞–Ω–Ω—ã–µ –∞–∫–∫–∞—É–Ω—Ç–æ–≤

api_id0 = '4454263'
api_hash0 = '61f812cbe0024e0353f475cb183ca47e'
phine0 = '+998903175516'

api_id001 = '12588062'
api_hash001 = 'd0f061c565991d6ed274285c0d032f7a'
phone001 = '+79816661471'

api_id002 = '13123883'
api_hash002 = 'f1fab12098570c2bf8848ad6ea23c62f'
phone002 = '+79676939873'

api_id003 = '19334807'
api_hash003 = '4b4edde7a9d46172399f0ac4cb98ae63'
phone003 = '+79842549006'

api_id004 = '16839412'
api_hash004 = 'aaa86871e0831e2ef1c9df22b921c9d4'
phone004 = '+79386950114'

api_id005 = '19179697'
api_hash005 = 'dd96018b9f53d55342f0c2c754c4fb29'
phone005 = '+79697678142'

api_id006 = '10904880'
api_hash006 = '0bce5ceebd00a5fe38dff632595b0bad'
phone006 = '+79587314180'

api_id007 = '20242585'
api_hash007 = '77312de9aab579af857c5d2fdb4e1d64'
phone007 = '+447424459503'

api_id008 = '20410656'
api_hash008 = '7f48793a7737fe3a910874c38a5f6e21'
phone008 = '+60149256978'

api_id009 = '24106632'
api_hash009 = '65093abacde2ca064ce8802c84863fec'
phone009 = '+447771411600'

api_id010 = '22353684'
api_hash010 = '98cf980e06b08c566679c9e17b317a41'
phone010 = '+447983221564'

cloud_password1 = '2303'


# –°–æ–∑–¥–∞–Ω–∏–µ –∫–ª–∏–µ–Ω—Ç–æ–≤ 
client0 = TelegramClient('session0', api_id0, api_hash0)
client001 = TelegramClient('session001', api_id001, api_hash001)
client002 = TelegramClient('session002', api_id002, api_hash002)
client003 = TelegramClient('session003', api_id003, api_hash003)
client004 = TelegramClient('session004', api_id004, api_hash004)
client005 = TelegramClient('session005', api_id005, api_hash005)
client006 = TelegramClient('session006', api_id006, api_hash006)
client007 = TelegramClient('session007', api_id007, api_hash007)
client008 = TelegramClient('session008', api_id008, api_hash008)
client009 = TelegramClient('session009', api_id009, api_hash009)
client010 = TelegramClient('session010', api_id010, api_hash010)

# –í—Ä–µ–º—è –∑–∞–ø—É—Å–∫–∞ —Å–∫—Ä–∏–ø—Ç–∞
start_time = datetime.datetime.now()

# –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è
clients1 = [client0, client001, client002, client003, client004, client005, client006, client007, client008, client009, client010]
# –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è
client0.connect()
if not client0.is_user_authorized():
    client0.send_code_request(phone0)
    try:
        client0.sign_in(phone001, input('Session-0 –í–≤–µ–¥–∏—Ç–µ –∫–æ–¥ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è: '), password=cloud_password1)
    except SessionPasswordNeededError:
        client0.sign_in(password=cloud_password1)

client001.connect()
if not client001.is_user_authorized():
    client001.send_code_request(phone001)
    try:
        client001.sign_in(phone001, input('Session-001 –í–≤–µ–¥–∏—Ç–µ –∫–æ–¥ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è: '), password=cloud_password1)
    except SessionPasswordNeededError:
        client001.sign_in(password=cloud_password1)

client002.connect()
if not client002.is_user_authorized():
    client002.send_code_request(phone002)
    try:
        client002.sign_in(phone002, input('Session-002 –í–≤–µ–¥–∏—Ç–µ –∫–æ–¥ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è: '), password=cloud_password1)
    except SessionPasswordNeededError:
        client002.sign_in(password=cloud_password1)

client003.connect()
if not client003.is_user_authorized():
    client003.send_code_request(phone003)
    try:
        client003.sign_in(phone003, input('Session-003 –í–≤–µ–¥–∏—Ç–µ –∫–æ–¥ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è: '), password=cloud_password1)
    except SessionPasswordNeededError:
        client003.sign_in(password=cloud_password1)

client004.connect()
if not client004.is_user_authorized():
    client004.send_code_request(phone004)
    try:
        client004.sign_in(phone004, input('Session-004 –í–≤–µ–¥–∏—Ç–µ –∫–æ–¥ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è: '), password=cloud_password1)
    except SessionPasswordNeededError:
        client004.sign_in(password=cloud_password1)

client005.connect()
if not client005.is_user_authorized():
    client005.send_code_request(phone005)
    try:
        client005.sign_in(phone005, input('Session-005 –í–≤–µ–¥–∏—Ç–µ –∫–æ–¥ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è: '), password=cloud_password1)
    except SessionPasswordNeededError:
        client005.sign_in(password=cloud_password1)

client006.connect()
if not client006.is_user_authorized():
    client006.send_code_request(phone006)
    try:
        client006.sign_in(phone006, input('Session-006 –í–≤–µ–¥–∏—Ç–µ –∫–æ–¥ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è: '), password=cloud_password1)
    except SessionPasswordNeededError:
        client006.sign_in(password=cloud_password1)

client007.connect()
if not client007.is_user_authorized():
    client007.send_code_request(phone007)
    try:
        client007.sign_in(phone007, input('Session-007 –í–≤–µ–¥–∏—Ç–µ –∫–æ–¥ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è: '), password=cloud_password1)
    except SessionPasswordNeededError:
        client007.sign_in(password=cloud_password1)

client008.connect()
if not client008.is_user_authorized():
    client008.send_code_request(phone008)
    try:
        client008.sign_in(phone008, input('Session-008 –í–≤–µ–¥–∏—Ç–µ –∫–æ–¥ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è: '), password=cloud_password1)
    except SessionPasswordNeededError:
        client008.sign_in(password=cloud_password1)

client009.connect()
if not client009.is_user_authorized():
    client009.send_code_request(phone009)
    try:
        client009.sign_in(phone009, input('Session-009 –í–≤–µ–¥–∏—Ç–µ –∫–æ–¥ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è: '), password=cloud_password1)
    except SessionPasswordNeededError:
        client009.sign_in(password=cloud_password1)

client010.connect()
if not client010.is_user_authorized():
    client010.send_code_request(phone010)
    try:
        client010.sign_in(phone010, input('Session-010 –í–≤–µ–¥–∏—Ç–µ –∫–æ–¥ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è: '), password=cloud_password1)
    except SessionPasswordNeededError:
        client010.sign_in(password=cloud_password1)

for client in clients1:
    client.start()

print('–ö–ª–∏–µ–Ω—Ç—ã —É—Å–ø–µ—à–Ω–æ –∑–∞–ø—É—â–µ–Ω—ã!')

# –ê–¥—Ä–µ—Å—ã
mineEvo_channel = '@mine_evo_news'
mineEvo_group = '@mineevochat'
my_channel = '@Demo_minePromo'
mine_evo = '@mine_evo_bot'
twins_group = '@twinsFarm_byDem'

count1 = 0
cycles1 = 0
kt = 0
rkt = 0
k = 0
rk = 0
mif = 0
kr = 0
pse = 0
ssp = 0
stop_sending1 = True
stop_sending2 = True
stop_sending3 = False
stop_sending4 = False
player_names1 = ['Gnom1', 'Gnom2', 'Gnom3', 'Gnom4', 'Gnom5', 'Gnom6', 'Gnom7', 'Gnom8', 'Gnom13', 'Gnom14', 'Gnom15', 'Gnom16', 'Gnom17', 'Gnom18', 'Gnom19', 'Gnom20', 'Gnom21', 'Gnom22', 'Gnom23', 'Gnom24', 'Gnom25', 'Gnom26', 'Gnom27', 'Gnom28', 'Gnom28', 'Gnom29', 'Gnom30', 'Gnom31', 'Gnom32', 'Gnom33', 'Gnom34', 'Gnom35', 'Gnom36', 'Gnom37', 'Gnom38', 'Gnom39', 'Gnom40', 'Gnom40', 'Gnom42', 'Gnom43', 'Gnom44', 'Gnom45', 'Gnom46', 'Gnom47']
async def send_message(client, mine_evo, message):
    try:
        await client.send_message(mine_evo, message)
    except FloodWaitError as e:
        # –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–∫–∏ FloodWaitError
        print(f"–û—à–∏–±–∫–∞ FloodWaitError –¥–ª—è –∫–ª–∏–µ–Ω—Ç–∞ {client}: {e}")
        clients1.disconnect(client)
    except ValueError as e:
        # –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–∫–∏, –µ—Å–ª–∏ –∫–ª–∏–µ–Ω—Ç –Ω–µ –Ω–∞–π–¥–µ–Ω –∏–ª–∏ –Ω–µ—Ç –¥–æ—Å—Ç—É–ø–∞ –∫ –∞–∫–∫–∞—É–Ω—Ç—É
        print(f"–û—à–∏–±–∫–∞: {e} –¥–ª—è –∫–ª–∏–µ–Ω—Ç–∞ {client}")
        clients1.disconnect(client)
    except ConnectionError:
        print('–û—à–∏–±–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è. –ü–æ–≤—Ç–æ—Ä–Ω–æ–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ...')
        await asyncio.sleep(15)  # –ñ–¥–µ–º 5 —Å–µ–∫—É–Ω–¥ –ø–µ—Ä–µ–¥ –ø–æ–≤—Ç–æ—Ä–Ω–æ–π –ø–æ–ø—ã—Ç–∫–æ–π
    except KeyboardInterrupt:
        pass
    except Exception as e:
        # –û–±—Ä–∞–±–æ—Ç–∫–∞ –¥—Ä—É–≥–∏—Ö –∏—Å–∫–ª—é—á–µ–Ω–∏–π
        print(f"–û—à–∏–±–∫–∞ –ø—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ —Å–æ–æ–±—â–µ–Ω–∏—è –¥–ª—è –∫–ª–∏–µ–Ω—Ç–∞ {client}: {e}")

@client001.on(events.NewMessage(pattern='m.off'))
async def stop_sending_messages(event):
    global stop_sending1
    stop_sending1 = True
    await event.message.edit('‚ùå–û—Ç–ø—Ä–∞–≤–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏–π –≤—ã–∫–ª—é—á–µ–Ω–∞')

@client001.on(events.NewMessage(pattern='m.on'))
async def start_sending_messages(event):
    global stop_sending1
    stop_sending1 = False
    await event.message.edit('‚úÖ–û—Ç–ø—Ä–∞–≤–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏–π –≤–∫–ª—é—á–µ–Ω–∞')


@client001.on(events.NewMessage(pattern='m.send'))
async def send_multiple_messages1(event):
    global count1
    global cycles1
    global clients1  # Declare clients1 as a global variable
    await event.message.edit('–ü—Ä–æ–±—É–µ–º –∫–æ–ø–∞—Ç—å...')
    chat_id = mine_evo
    if stop_sending1:
        await asyncio.sleep(4) 
        await event.message.edit('‚ò†Ô∏è–ù–µ–≤–æ–∑–º–æ–∂–Ω–æ –Ω–∞—á–∞—Ç—å –∫–æ–ø–∞—Ç—å\n–û—Ç–ø—Ä–∞–≤–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏–π –≤—ã–∫–ª—é—á–µ–Ω–∞')
    else:
        await asyncio.sleep(2)
        await event.message.edit('üí¢–ù–∞—á–∏–Ω–∞–µ–º –∫–æ–ø–∞—Ç—å')
    while not stop_sending1:
        coroutines = []
        for client in clients1:
            coroutines.append(send_message(client, chat_id, '–∫–æ–ø'))
        await asyncio.gather(*coroutines)
        await asyncio.sleep(2)
        count1 += 10
        cycles1 += 1
        clients1 = [client for client in clients1 if client.is_connected()]

        if not clients1:
            print("–í—Å–µ –∫–ª–∏–µ–Ω—Ç—ã –ø–æ—Ç–µ—Ä—è–ª–∏ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ.")
            break


# –ú–æ–¥—É–ª—å –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –∫–µ–π—Å–æ–≤
@client001.on(events.NewMessage(pattern='m.cases'))
async def cases_info1(event):
    # –¢–µ–∫—Å—Ç –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏—è 
    message = '–∫–µ–π—Å—ã'
    for client in clients1:
        await asyncio.sleep(2)
        await client(SendMessageRequest(mine_evo, message))

# –ú–æ–¥—É–ª—å –¥–ª—è –µ–∂–µ–¥–Ω–µ–≤–Ω–æ–≥–æ –±–æ–Ω—É—Å–∞
@client001.on(events.NewMessage(pattern='m.day'))
async def cases_info1(event):
    # –¢–µ–∫—Å—Ç –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏—è 
    message = '–µ–±'
    for client in clients1:
        await asyncio.sleep(2)
        await client(SendMessageRequest(mine_evo, message))

# –û—Ç–ø—Ä–∞–≤–∫–∞ –∫–µ–π—Å–æ–≤

# –°–ø–∏—Å–æ–∫ –∫–µ–π—Å–æ–≤
cases_list = {
    "‚úâ": "–∫—Ç",
    "üßß": "—Ä–∫—Ç",
    "üì¶": "–∫",
    "üó≥": "—Ä–∫",
    "üïã": "–º–∏—Ñ",
    "üíé": "–∫—Ä",
    "üé≤": "–¥–∫",
    "üåå": "–∑–≤",
    "üëú": "—Å—Å–ø",
    "üíº": "–ø—Å—ç"
}

async def send_transfer_message1(client, chat_id, case_name, quantity):
    # –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –Ω–∞–∑–≤–∞–Ω–∏—è –∫–µ–π—Å–∞ –¥–ª—è –ø–µ—Ä–µ–¥–∞—á–∏
    case_alias = cases_list.get(case_name, "")
    # –°–æ–æ–±—â–µ–Ω–∏–µ –æ –ø–µ—Ä–µ–¥–∞—á–µ
    transfer_message1 = f"–ü–µ—Ä–µ–¥–∞—Ç—å GOD_ZEPHYR {case_alias} {quantity}"
    await client.send_message(chat_id, transfer_message1)
    # –ó–∞–¥–µ—Ä–∂–∫–∞ 
    await asyncio.sleep(3)
async def send_transfer_messages1(client, event):
    # –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ id —á–∞—Ç–∞
    chat_id = '@mine_evo_bot'
    # –°–æ–æ–±—â–µ–Ω–∏–µ –∫–æ—Ç–æ—Ä–æ–µ –±—É–¥–µ—Ç –ø—Ä–æ–≤–µ—Ä—è—Ç—å—Å—è 
    message = event.raw_text
    lines = message.split("\n")
    # –û–±—Ä–∞–±–æ—Ç–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏—è –∏ –æ—Ç–ø—Ä–∞–≤–∫–∞
    for line in lines:
        for case in cases_list:
            if case in line:
                item = line.split("—à—Ç.")
                if len(item) >= 2:
                    item = item[0].split(":")
                    if len(item) >= 2:
                        item = item[1].strip()
                        await send_transfer_message1(client, chat_id, case, item)

# –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∞ –≤—Ö–æ–¥—è—â–∏—Ö —Å–æ–æ–±—â–µ–Ω–∏–π1
for i, client in enumerate(clients1):
    @client.on(events.NewMessage)
    async def handle_incoming_message(event, client=client):
        for player_name in player_names1:
            if f"üì¶ –ö–µ–π—Å—ã –∏–≥—Ä–æ–∫–∞\n{player_name}" in event.raw_text:
                await asyncio.sleep(2)
                await send_transfer_messages1(client, event)

@client.on(events.NewMessage)
    async def handle_incoming_message(event, client=client):
        global kt 
        global rkt 
        glibal k
        global rk 
        global mif
        global kr
        glibal pse
        global ssp 
        for client in clients1:
            if message.sender_id == 5522271758:
                if "‚úâ –ù–∞–π–¥–µ–Ω –ö–æ–Ω–≤–µ—Ä—Ç +1" in event.raw_text:
                    kt += 1
                if "‚ú® üßß –ù–∞–π–¥–µ–Ω –†–µ–¥–∫–∏–π –ö–æ–Ω–≤–µ—Ä—Ç +1" in event.raw_text:
                    rkt += 1
                if "‚ú® üì¶ –ù–∞–π–¥–µ–Ω –ö–µ–π—Å +1" in event.raw_text:
                    k += 1
                if "‚ú® üó≥ –ù–∞–π–¥–µ–Ω –†–µ–¥–∫–∏–π –ö–µ–π—Å +1" in event.raw_text:
                    rk += 1
                if "‚ú® üïã –ù–∞–π–¥–µ–Ω –ú–∏—Ñ–∏—á–µ—Å–∫–∏–π –ö–µ–π—Å +1" in event.raw_text:
                    mif += 1
                if "üíé –ù–∞–π–¥–µ–Ω –ö—Ä–∏—Å—Ç–∞–ª—å–Ω—ã–π –ö–µ–π—Å +1" in event.raw_text:
                    kr += 1
                if "üíé –ù–∞–π–¥–µ–Ω –ö—Ä–∏—Å—Ç–∞–ª—å–Ω—ã–π –ö–µ–π—Å +1" in event.raw_text:
                    kr += 1
                if "üòÑ –ù–∞–π–¥–µ–Ω –ü–æ—Ä—Ç—Ñ–µ–ª—å c –≠—Å–∫–∏–∑–∞–º–∏ +1" in event.raw_text:
                    pse += 1
                if "‚ú® üòÑ –ù–∞–π–¥–µ–Ω –°—É–º–∫–∞ c –ü—Ä–µ–¥–º–µ—Ç–∞–º–∏ +1" in event.raw_text:
                    ssp += 1

# –§—É–Ω–∫—Ü–∏—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –≤—Ä–µ–º–µ–Ω–∏ —Ä–∞–±–æ—Ç—ã —Å–∫—Ä–∏–ø—Ç–∞
def get_elapsed_time():
    current_time = datetime.datetime.now()
    elapsed_time = current_time - start_time
    elapsed_time_str = str(elapsed_time).split('.')[0]  # –û—Ç—Å–µ–∫–∞–µ–º –º–∏–ª–ª–∏—Å–µ–∫—É–Ω–¥—ã
    return elapsed_time_str

@client0.on(events.NewMessage(pattern='m.info'))
async def get_info1(event):
    global count1
    global cycles1
    elapsed_time_str = get_elapsed_time()
    # –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ id —á–∞—Ç–∞
    chat_id = event.chat_id
    # –û—Ç–ø—Ä–∞–≤–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏—è —Å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π –æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–µ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π
    await send_message(client0, chat_id, f'üßë‚Äçüíª ScriptInfo\n\nüë• –ê–∫–∫–∞—É–Ω—Ç–æ–≤ —Ä–∞–±–æ—Ç–∞–µ—Ç: ‚àû\nüì® –û—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ —Å–æ–æ–±—â–µ–Ω–∏–π: {count1}\nüî≥ –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ –∫–µ–π—Å–∞–º:\n–ù–∞–π–¥–µ–Ω–æ ‚úâ –ö–æ–Ω–≤–µ—Ä—Ç–æ–≤: {kt}\n–ù–∞–π–¥–µ–Ω–æ üßß –†–µ–¥–∫–∏—Ö –∫–æ–Ω–≤–µ—Ä—Ç–æ–≤: {rkt}\n–ù–∞–π–¥–µ–Ω–æ üì¶ –ö–µ–π—Å–æ–≤: {k}\n–ù–∞–π–¥–µ–Ω–æ üó≥ –†–µ–¥–∫–∏—Ö –∫–µ–π—Å–æ–≤: {rk}\n–ù–∞–π–¥–µ–Ω–æ üïã –ú–∏—Ñ–∏—á–µ—Å–∫–∏—Ö –∫–µ–π—Å–æ–≤: {mif}\n–ù–∞–π–¥–µ–Ω–æ üé≤ –î–∞–π—Å –ö–µ–π—Å–æ–≤: {dice}\n\n\nüåÄ –ü—Ä–æ–π–¥–µ–Ω–æ —Ü–∏–∫–ª–æ–≤: {cycles1}\n‚åõ –í—Ä–µ–º—è —Å –∑–∞–ø—É—Å–∫–∞ —Å–∫—Ä–∏–ø—Ç–∞: {elapsed_time_str}')

# –ü—Ä–æ–º–æ-–ö–æ–¥—ã
@client001.on(events.NewMessage(chats=[mineEvo_channel, mineEvo_group, my_channel]))  
async def process_new_message(event):
    # –°–æ–æ–±—â–µ–Ω–∏–µ –∫–æ—Ç–æ—Ä–æ–µ –±—É–¥–µ—Ç –ø—Ä–æ–≤–µ—Ä—è—Ç—å—Å—è 
    message = event.message
    if '–ü—Ä–æ–º–æ' in message.message:
        promo_code = message.message.split('–ü—Ä–æ–º–æ ')[1].split()[0]
        for client in clients1:
            await client(SendMessageRequest(mine_evo, f'–ø—Ä–æ–º–æ {promo_code}'))

for client in clients1:
    try:
        client.run_until_disconnected()
    except KeyboardInterrupt:
        pass
    finally:
        client.disconnect()

